{"ast":null,"code":"import _slicedToArray from\"/Users/tanmaysinghal98/Development/isah/isah-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import ReactLoading from'react-loading';import axios from'axios';import{useCookies}from'react-cookie';import'../styles/Common.css';import'../styles/ImageUpload.css';var ImageShare=function ImageShare(props){var challenge=props.challenge,user=props.user;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),imageDownload=_useState2[0],setImageDownload=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useCookies=useCookies(['isah_id']),_useCookies2=_slicedToArray(_useCookies,2),cookie=_useCookies2[0],setCookie=_useCookies2[1];useEffect(function(){var completedChallenge=user.challengesCompleted.find(function(compChal){return compChal.challengeId===challenge.id;});var data={'key':completedChallenge.achievementImageKey};axios.post('/image/download',data,{headers:{'Authorization':cookie.isah_id}}).then(function(response){return setImageDownload(response.data);}).catch(function(err){return console.log(err);});},[challenge,user]);useEffect(function(){if(imageDownload.url!==undefined&&imageDownload.url!==null){setLoading(true);fetch(imageDownload.url).then(function(response){return response.blob();}).then(function(blob){var file=new File([blob],'download.jpeg',{type:\"image/jpeg\"});setImage(file);setLoading(false);});}},[imageDownload]);var share=function share(){if(navigator.canShare&&navigator.canShare({files:[image]})){navigator.share({files:[image],text:'I nominate you to complete this challenge. https://istayathome.in/challenge/'+challenge.id}).then(function(){return console.log('Share was successful.');}).catch(function(error){return downloadImage();});}else{downloadImage();}};var downloadImage=function downloadImage(){var a=document.createElement(\"a\");document.body.appendChild(a);a.style=\"display: none\";a.href=window.URL.createObjectURL(image);a.download='download.jpeg';a.click();};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"image-preview\"},image?/*#__PURE__*/React.createElement(\"img\",{src:window.URL.createObjectURL(image),width:\"50%\",className:\"image-preview\",alt:\"Challenge Completed\"}):null))),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6 text-center\"},loading?/*#__PURE__*/React.createElement(ReactLoading,{type:'bubbles',color:'#000000',height:'20%',width:'20%',className:\"loading\"}):/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black text-large\",onClick:share},\"Share\"))));};export default ImageShare;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageShare.js"],"names":["React","useState","useEffect","ReactLoading","axios","useCookies","ImageShare","props","challenge","user","imageDownload","setImageDownload","image","setImage","loading","setLoading","cookie","setCookie","completedChallenge","challengesCompleted","find","compChal","challengeId","id","data","achievementImageKey","post","headers","isah_id","then","response","catch","err","console","log","url","undefined","fetch","blob","file","File","type","share","navigator","canShare","files","text","error","downloadImage","a","document","createElement","body","appendChild","style","href","window","URL","createObjectURL","download","click"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport ReactLoading from 'react-loading';\nimport axios from 'axios';\nimport { useCookies } from 'react-cookie';\nimport '../styles/Common.css';\nimport '../styles/ImageUpload.css'\n\nconst ImageShare = (props) => {\n    const {challenge, user} = props;\n    const [imageDownload, setImageDownload] = useState({});\n    const [image, setImage] = useState(null);\n    const [loading, setLoading] = useState(true)\n    const [cookie, setCookie] = useCookies(['isah_id']);\n\n    useEffect(() => {\n        var completedChallenge = user.challengesCompleted.find(compChal => compChal.challengeId === challenge.id)\n        var data = {\n            'key': completedChallenge.achievementImageKey\n        }\n        axios.post('/image/download', data, {headers: {'Authorization': cookie.isah_id}})\n            .then(response => setImageDownload(response.data))\n            .catch(err => console.log(err))\n    }, [challenge, user])\n\n    useEffect(() => {\n        if (imageDownload.url !== undefined && imageDownload.url !== null) {\n            setLoading(true);\n            fetch(imageDownload.url)\n            .then(response => response.blob())\n            .then(blob => {\n                let file = new File([blob], 'download.jpeg', { type: \"image/jpeg\" });\n                setImage(file)\n                setLoading(false)\n            })\n        }\n    }, [imageDownload])\n\n    const share = () => {\n        if (navigator.canShare && navigator.canShare({ files: [image] })) {\n            navigator.share({\n              files: [image],\n              text: 'I nominate you to complete this challenge. https://istayathome.in/challenge/' + challenge.id\n            })\n            .then(() => console.log('Share was successful.'))\n            .catch((error) => downloadImage());\n          } else {\n            downloadImage();\n          }\n    }\n\n    const downloadImage = () => {\n        var a = document.createElement(\"a\");\n        document.body.appendChild(a);\n        a.style = \"display: none\";\n        a.href = window.URL.createObjectURL(image);\n        a.download = 'download.jpeg';\n        a.click();\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    <div className='image-preview'>\n                        {image ? \n                        <img src={window.URL.createObjectURL(image)} width='50%' className='image-preview' alt='Challenge Completed'/>\n                        : null}\n                    </div>\n                </div>\n            </div>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {loading? \n                        <ReactLoading type={'bubbles'} color={'#000000'} height={'20%'} width={'20%'} className='loading' />:\n                        <button className='button-rounded-black text-large' onClick={share}>Share</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageShare;"]},"metadata":{},"sourceType":"module"}