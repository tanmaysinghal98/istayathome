{"ast":null,"code":"import _slicedToArray from\"/Users/tanmaysinghal98/Development/isah/isah-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useState,useEffect}from'react';import axios from'axios';import ReactLoading from'react-loading';import{useDropzone}from'react-dropzone';import'../styles/ImageUpload.css';import'../styles/Common.css';var ImageUpload=function ImageUpload(props){var challenge=props.challenge;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),imageUpload=_useState6[0],setImageUpload=_useState6[1];useEffect(function(){if(Object.keys(image).length!==0){getPresignedUrl(image);}},[image]);var onDrop=useCallback(function(acceptedFiles){setImage(acceptedFiles[0]);},[]);var getPresignedUrl=function getPresignedUrl(file){var data={'challengeId':props.challenge.id,'fileName':file.name,'fileType':file.type};axios.post('/image/upload',data).then(function(response){setImageUpload(response.data);}).catch(function(error){console.log(error);});};var _useDropzone=useDropzone({onDrop:onDrop,accept:'image/*',multiple:false}),getRootProps=_useDropzone.getRootProps,getInputProps=_useDropzone.getInputProps,isDragActive=_useDropzone.isDragActive;var submitChallenge=function submitChallenge(){setLoading(true);var data={'challengeId':challenge.id,'uploadedFileKey':imageUpload.key};axios.post('/submit',data).then(function(response){props.onUpload(response.data);setLoading(false);}).catch(function(error){return console.log(error);});};var uploadImage=function uploadImage(){var blob=image.slice(0,image.size,image.type);var renameFile=new File([blob],imageUpload.key,{type:image.type});var req=new XMLHttpRequest();req.open(\"PUT\",imageUpload.url);req.onreadystatechange=function(){if(this.readyState===4&&this.status===200){console.log(\"File Uploaded\");submitChallenge();}};req.send(renameFile);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6\"},Object.keys(image).length===0?/*#__PURE__*/React.createElement(\"div\",Object.assign({},getRootProps(),{className:\"dropbox\"}),/*#__PURE__*/React.createElement(\"input\",getInputProps()),isDragActive?/*#__PURE__*/React.createElement(\"div\",{className:\"drag-text\"},\"Drop image here\"):/*#__PURE__*/React.createElement(\"div\",{className:\"drag-text\"},\"Drag 'n' drop image here, or click to select a file\")):/*#__PURE__*/React.createElement(\"div\",{className:\"image-preview\"},/*#__PURE__*/React.createElement(\"img\",{src:URL.createObjectURL(image),width:\"50%\",className:\"image-preview\"})))),loading?/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6 text-center\"},/*#__PURE__*/React.createElement(ReactLoading,{type:'bubbles',color:'#000000',height:'20%',width:'20%',className:\"loading\"}))):null,/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6 text-center\"},loading?/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black-disabled text-large\",disabled:true},\"Uploading\"):Object.keys(imageUpload).length===0?/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black-disabled text-large\",disabled:true},\"Upload\"):/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black text-large\",onClick:uploadImage},\"Upload\"))));};export default ImageUpload;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageUpload.js"],"names":["React","useCallback","useState","useEffect","axios","ReactLoading","useDropzone","ImageUpload","props","challenge","image","setImage","loading","setLoading","imageUpload","setImageUpload","Object","keys","length","getPresignedUrl","onDrop","acceptedFiles","file","data","id","name","type","post","then","response","catch","error","console","log","accept","multiple","getRootProps","getInputProps","isDragActive","submitChallenge","key","onUpload","uploadImage","blob","slice","size","renameFile","File","req","XMLHttpRequest","open","url","onreadystatechange","readyState","status","send","URL","createObjectURL"],"mappings":"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","sourcesContent":["import React, {useCallback, useState, useEffect} from 'react';\nimport axios from 'axios';\nimport ReactLoading from 'react-loading';\nimport {useDropzone} from 'react-dropzone'\nimport '../styles/ImageUpload.css'\nimport '../styles/Common.css';\n\nconst ImageUpload = (props) => {\n    const {challenge} = props;\n    const [image, setImage] = useState({});\n    const [loading, setLoading] = useState(false)\n    const [imageUpload, setImageUpload] = useState({});\n\n    useEffect(() => {\n        if (Object.keys(image).length !== 0) {\n            getPresignedUrl(image)\n        }\n    }, [image])\n\n    const onDrop = useCallback(acceptedFiles => {\n        setImage(acceptedFiles[0])\n    }, []);\n\n    const getPresignedUrl = (file) => {\n        var data = {\n            'challengeId': props.challenge.id,\n            'fileName' : file.name,\n            'fileType': file.type\n        }\n        axios.post('/image/upload', data)\n            .then(response => {\n                setImageUpload(response.data);\n            })\n            .catch(function (error){\n                console.log(error);\n            })\n    }\n    \n    const {getRootProps, getInputProps, isDragActive} = useDropzone({\n        onDrop,\n        accept: 'image/*',\n        multiple: false\n    });\n\n    const submitChallenge = () => {\n        setLoading(true)\n        var data = {\n            'challengeId': challenge.id,\n            'uploadedFileKey': imageUpload.key\n        }\n        axios.post('/submit', data)\n            .then(response => {\n                props.onUpload(response.data)\n                setLoading(false)\n            })\n            .catch(error => console.log(error))\n    }\n\n    const uploadImage = () => {\n        var blob = image.slice(0, image.size, image.type);\n        var renameFile = new File([blob], imageUpload.key, { type: image.type });\n        let req = new XMLHttpRequest();\n        req.open(\"PUT\", imageUpload.url);\n        req.onreadystatechange = function () {\n          if (this.readyState === 4 && this.status === 200) {\n            console.log(\"File Uploaded\")\n            submitChallenge()\n          }\n        }\n        req.send(renameFile);\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    {Object.keys(image).length === 0? \n                        <div {...getRootProps()} className='dropbox'>\n                            <input {...getInputProps()} />\n                            {\n                                isDragActive ? \n                                <div className='drag-text'>Drop image here</div> :\n                                <div className='drag-text'>Drag 'n' drop image here, or click to select a file</div>\n                            }\n                        </div> :\n                        <div className='image-preview'>\n                            <img src={URL.createObjectURL(image)} width='50%' className='image-preview'/>\n                        </div>\n                    }\n                </div>\n            </div>\n            {loading ? \n                <div className='row justify-content-md-center description-box'>\n                    <div className='col-sm-12 col-md-6 text-center'>\n                        <ReactLoading type={'bubbles'} color={'#000000'} height={'20%'} width={'20%'} className='loading' />\n                    </div>\n                </div> : null\n            }\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {loading ? \n                    <button className='button-rounded-black-disabled text-large' disabled>Uploading</button>:\n                    Object.keys(imageUpload).length === 0? \n                        <button className='button-rounded-black-disabled text-large' disabled>Upload</button>:\n                        <button className='button-rounded-black text-large' onClick={uploadImage}>Upload</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageUpload;"]},"metadata":{},"sourceType":"module"}