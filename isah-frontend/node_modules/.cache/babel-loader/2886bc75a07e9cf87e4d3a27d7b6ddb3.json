{"ast":null,"code":"var _jsxFileName = \"/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageShare.js\";\nimport React, { useState, useEffect } from 'react';\nimport ReactLoading from 'react-loading';\nimport axios from 'axios';\nimport { useCookies } from 'react-cookie';\nimport '../styles/Common.css';\nimport '../styles/ImageUpload.css';\n\nconst ImageShare = props => {\n  const {\n    challenge,\n    user\n  } = props;\n  const [imageDownload, setImageDownload] = useState({});\n  const [image, setImage] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [cookie, setCookie] = useCookies(['isah_id']);\n  useEffect(() => {\n    var completedChallenge = user.challengesCompleted.find(compChal => compChal.challengeId === challenge.id);\n    var data = {\n      'key': completedChallenge.achievementImageKey\n    };\n    axios.post('/image/download', data, {\n      headers: {\n        'Authorization': cookie.isah_id\n      }\n    }).then(response => setImageDownload(response.data)).catch(err => console.log(err));\n  }, [challenge, user]);\n  useEffect(() => {\n    if (imageDownload.url !== undefined && imageDownload.url !== null) {\n      setLoading(true);\n      fetch(imageDownload.url).then(response => response.blob()).then(blob => {\n        let file = new File([blob], 'download.jpeg', {\n          type: \"image/jpeg\"\n        });\n        setImage(file);\n        setLoading(false);\n      });\n    }\n  }, [imageDownload]);\n\n  const share = () => {\n    if (navigator.canShare && navigator.canShare({\n      files: [image]\n    })) {\n      navigator.share({\n        files: [image],\n        text: 'I nominate you to complete this challenge. https://istayathome.in/challenge/' + challenge.id\n      }).then(() => console.log('Share was successful.')).catch(error => downloadImage());\n    } else {\n      downloadImage();\n    }\n  };\n\n  const downloadImage = () => {\n    var a = document.createElement(\"a\");\n    document.body.appendChild(a);\n    a.style = \"display: none\";\n    a.href = window.URL.createObjectURL(image);\n    a.download = 'download.jpeg';\n    a.click();\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row justify-content-md-center description-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12 col-md-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"image-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 21\n    }\n  }, image ? /*#__PURE__*/React.createElement(\"img\", {\n    src: window.URL.createObjectURL(image),\n    width: \"50%\",\n    className: \"image-preview\",\n    alt: \"Challenge Completed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 25\n    }\n  }) : null))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row justify-content-md-center description-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12 col-md-6 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, loading ? /*#__PURE__*/React.createElement(ReactLoading, {\n    type: 'bubbles',\n    color: '#000000',\n    height: '20%',\n    width: '20%',\n    className: \"loading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button-rounded-black text-large\",\n    onClick: share,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 25\n    }\n  }, \"Share\"))));\n};\n\nexport default ImageShare;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageShare.js"],"names":["React","useState","useEffect","ReactLoading","axios","useCookies","ImageShare","props","challenge","user","imageDownload","setImageDownload","image","setImage","loading","setLoading","cookie","setCookie","completedChallenge","challengesCompleted","find","compChal","challengeId","id","data","achievementImageKey","post","headers","isah_id","then","response","catch","err","console","log","url","undefined","fetch","blob","file","File","type","share","navigator","canShare","files","text","error","downloadImage","a","document","createElement","body","appendChild","style","href","window","URL","createObjectURL","download","click"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport ReactLoading from 'react-loading';\nimport axios from 'axios';\nimport { useCookies } from 'react-cookie';\nimport '../styles/Common.css';\nimport '../styles/ImageUpload.css'\n\nconst ImageShare = (props) => {\n    const {challenge, user} = props;\n    const [imageDownload, setImageDownload] = useState({});\n    const [image, setImage] = useState(null);\n    const [loading, setLoading] = useState(false)\n    const [cookie, setCookie] = useCookies(['isah_id']);\n\n    useEffect(() => {\n        var completedChallenge = user.challengesCompleted.find(compChal => compChal.challengeId === challenge.id)\n        var data = {\n            'key': completedChallenge.achievementImageKey\n        }\n        axios.post('/image/download', data, {headers: {'Authorization': cookie.isah_id}})\n            .then(response => setImageDownload(response.data))\n            .catch(err => console.log(err))\n    }, [challenge, user])\n\n    useEffect(() => {\n        if (imageDownload.url !== undefined && imageDownload.url !== null) {\n            setLoading(true);\n            fetch(imageDownload.url)\n            .then(response => response.blob())\n            .then(blob => {\n                let file = new File([blob], 'download.jpeg', { type: \"image/jpeg\" });\n                setImage(file)\n                setLoading(false)\n            })\n        }\n    }, [imageDownload])\n\n    const share = () => {\n        if (navigator.canShare && navigator.canShare({ files: [image] })) {\n            navigator.share({\n              files: [image],\n              text: 'I nominate you to complete this challenge. https://istayathome.in/challenge/' + challenge.id\n            })\n            .then(() => console.log('Share was successful.'))\n            .catch((error) => downloadImage());\n          } else {\n            downloadImage();\n          }\n    }\n\n    const downloadImage = () => {\n        var a = document.createElement(\"a\");\n        document.body.appendChild(a);\n        a.style = \"display: none\";\n        a.href = window.URL.createObjectURL(image);\n        a.download = 'download.jpeg';\n        a.click();\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    <div className='image-preview'>\n                        {image ? \n                        <img src={window.URL.createObjectURL(image)} width='50%' className='image-preview' alt='Challenge Completed'/>\n                        : null}\n                    </div>\n                </div>\n            </div>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {loading? \n                        <ReactLoading type={'bubbles'} color={'#000000'} height={'20%'} width={'20%'} className='loading' />:\n                        <button className='button-rounded-black text-large' onClick={share}>Share</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageShare;"]},"metadata":{},"sourceType":"module"}