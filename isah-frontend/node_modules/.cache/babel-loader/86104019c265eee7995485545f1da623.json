{"ast":null,"code":"import _slicedToArray from\"/Users/tanmaysinghal98/Development/isah/isah-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useState,useEffect}from'react';import axios from'axios';import'../styles/Common.css';import'../styles/ImageUpload.css';var ImageShare=function ImageShare(props){var challenge=props.challenge,user=props.user;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),imageDownload=_useState2[0],setImageDownload=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var element=React.createRef();useEffect(function(){var completedChallenge=user.challengesCompleted.find(function(compChal){return compChal.challengeId===challenge.id;});var data={'key':completedChallenge.achievementImageKey};axios.post('/image/download',data).then(function(response){return setImageDownload(response.data);}).catch(function(err){return console.log(err);});},[challenge,user]);useEffect(function(){if(imageDownload.url!==undefined&&imageDownload.url!==null){console.log(\"hi\");fetch(imageDownload.url).then(function(response){return response.blob();}).then(function(blob){var file=new File([blob],'download.jpg',{type:\"image/jpg\"});setImage(file);});}},[imageDownload]);useEffect(function(){if(element.current!=null){element.current.addEventListener('click',share);}},[element]);var share=function share(){if(navigator.canShare&&navigator.canShare({files:[image]})){alert(\"yes\");navigator.share({files:[image]//   title: 'Vacation Pictures',\n//   text: 'Photos from September 27 to October 14.',\n}).then(function(){return console.log('Share was successful.');}).catch(function(error){return alert(error);});}else{console.log(\"Your system doesn't support sharing files.\");}};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"image-preview\"},image?/*#__PURE__*/React.createElement(\"img\",{src:window.URL.createObjectURL(image),width:\"50%\",className:\"image-preview\"}):null))),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6 text-center\"},Object.keys(imageDownload).length===0?/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black-disabled text-large\",disabled:true},\"Share\"):/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black text-large\",ref:element},\"Share\"))));};export default ImageShare;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageShare.js"],"names":["React","useCallback","useState","useEffect","axios","ImageShare","props","challenge","user","imageDownload","setImageDownload","image","setImage","element","createRef","completedChallenge","challengesCompleted","find","compChal","challengeId","id","data","achievementImageKey","post","then","response","catch","err","console","log","url","undefined","fetch","blob","file","File","type","current","addEventListener","share","navigator","canShare","files","alert","error","window","URL","createObjectURL","Object","keys","length"],"mappings":"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","sourcesContent":["import React, {useCallback, useState, useEffect} from 'react';\nimport axios from 'axios';\nimport '../styles/Common.css';\nimport '../styles/ImageUpload.css'\n\nconst ImageShare = (props) => {\n    const {challenge, user} = props;\n    const [imageDownload, setImageDownload] = useState({});\n    const [image, setImage] = useState(null);\n    var element = React.createRef();\n\n    useEffect(() => {\n        var completedChallenge = user.challengesCompleted.find(compChal => compChal.challengeId === challenge.id)\n        var data = {\n            'key': completedChallenge.achievementImageKey\n        }\n        axios.post('/image/download', data)\n            .then(response => setImageDownload(response.data))\n            .catch(err => console.log(err))\n    }, [challenge, user])\n\n    useEffect(() => {\n        if (imageDownload.url !== undefined && imageDownload.url !== null) {\n            console.log(\"hi\")\n            fetch(imageDownload.url)\n            .then(response => response.blob())\n            .then(blob => {\n                let file = new File([blob], 'download.jpg', { type: \"image/jpg\" });\n                setImage(file)\n            })\n        }\n    }, [imageDownload])\n\n    useEffect(() => {\n        if (element.current != null) {\n            element.current.addEventListener('click', share)\n        }\n        \n    }, [element])\n\n    const share = () => {\n        if (navigator.canShare && navigator.canShare({ files: [image] })) {\n            alert(\"yes\")\n            navigator.share({\n              files: [image]\n            //   title: 'Vacation Pictures',\n            //   text: 'Photos from September 27 to October 14.',\n            })\n            .then(() => console.log('Share was successful.'))\n            .catch((error) => alert(error));\n          } else {\n            console.log(`Your system doesn't support sharing files.`);\n          }\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    <div className='image-preview'>\n                        {image ? \n                        <img src={window.URL.createObjectURL(image)} width='50%' className='image-preview'/>\n                        : null}\n                    </div>\n                </div>\n            </div>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {Object.keys(imageDownload).length === 0? \n                        <button className='button-rounded-black-disabled text-large' disabled>Share</button>:\n                        <button className='button-rounded-black text-large' ref={element}>Share</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageShare;"]},"metadata":{},"sourceType":"module"}