{"ast":null,"code":"import _slicedToArray from\"/Users/tanmaysinghal98/Development/isah/isah-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useState,useEffect}from'react';import axios from'axios';import{useDropzone}from'react-dropzone';import'../styles/ImageUpload.css';import'../styles/Common.css';var ImageUpload=function ImageUpload(props){var challenge=props.challenge;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),imageUpload=_useState4[0],setImageUpload=_useState4[1];useEffect(function(){if(Object.keys(image).length!==0){getPresignedUrl(image);}},[image]);var onDrop=useCallback(function(acceptedFiles){setImage(acceptedFiles[0]);},[]);var getPresignedUrl=function getPresignedUrl(file){var data={'challengeId':props.challenge.id,'fileName':file.name,'fileType':file.type};axios.post('/image/upload',data).then(function(response){setImageUpload(response.data);}).catch(function(error){console.log(error);});};var _useDropzone=useDropzone({onDrop:onDrop,accept:'image/*',multiple:false}),getRootProps=_useDropzone.getRootProps,getInputProps=_useDropzone.getInputProps,isDragActive=_useDropzone.isDragActive;var submitChallenge=function submitChallenge(){var data={'challengeId':challenge.id,'uploadedFileKey':imageUpload.key};axios.post('/submit',data).then(function(response){return props.onUpload(response.data);}).catch(function(error){return console.log(error);});};var uploadImage=function uploadImage(){var blob=image.slice(0,image.size,image.type);var renameFile=new File([blob],imageUpload.key,{type:image.type});console.log(renameFile);var req=new XMLHttpRequest();req.open(\"PUT\",imageUpload.url);req.onreadystatechange=function(){if(this.readyState===4&&this.status===200){console.log(\"File Uploaded\");submitChallenge();}};req.send(renameFile);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6\"},Object.keys(image).length===0?/*#__PURE__*/React.createElement(\"div\",Object.assign({},getRootProps(),{className:\"dropbox\"}),/*#__PURE__*/React.createElement(\"input\",getInputProps()),isDragActive?/*#__PURE__*/React.createElement(\"div\",{className:\"drag-text\"},\"Drop image here\"):/*#__PURE__*/React.createElement(\"div\",{className:\"drag-text\"},\"Drag 'n' drop image here, or click to select a file\")):/*#__PURE__*/React.createElement(\"div\",{className:\"image-preview\"},/*#__PURE__*/React.createElement(\"img\",{src:URL.createObjectURL(image),width:\"50%\",className:\"image-preview\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6 text-center\"},Object.keys(imageUpload).length===0?/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black-disabled text-large\",disabled:true},\"Upload\"):/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black text-large\",onClick:uploadImage},\"Upload\"))));};export default ImageUpload;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageUpload.js"],"names":["React","useCallback","useState","useEffect","axios","useDropzone","ImageUpload","props","challenge","image","setImage","imageUpload","setImageUpload","Object","keys","length","getPresignedUrl","onDrop","acceptedFiles","file","data","id","name","type","post","then","response","catch","error","console","log","accept","multiple","getRootProps","getInputProps","isDragActive","submitChallenge","key","onUpload","uploadImage","blob","slice","size","renameFile","File","req","XMLHttpRequest","open","url","onreadystatechange","readyState","status","send","URL","createObjectURL"],"mappings":"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","sourcesContent":["import React, {useCallback, useState, useEffect} from 'react';\nimport axios from 'axios';\nimport {useDropzone} from 'react-dropzone'\nimport '../styles/ImageUpload.css'\nimport '../styles/Common.css';\n\nconst ImageUpload = (props) => {\n    const {challenge} = props;\n    const [image, setImage] = useState({});\n    const [imageUpload, setImageUpload] = useState({});\n\n    useEffect(() => {\n        if (Object.keys(image).length !== 0) {\n            getPresignedUrl(image)\n        }\n    }, [image])\n\n    const onDrop = useCallback(acceptedFiles => {\n        setImage(acceptedFiles[0])\n    }, []);\n\n    const getPresignedUrl = (file) => {\n        var data = {\n            'challengeId': props.challenge.id,\n            'fileName' : file.name,\n            'fileType': file.type\n        }\n        axios.post('/image/upload', data)\n            .then(response => {\n                setImageUpload(response.data);\n            })\n            .catch(function (error){\n                console.log(error);\n            })\n    }\n    \n    const {getRootProps, getInputProps, isDragActive} = useDropzone({\n        onDrop,\n        accept: 'image/*',\n        multiple: false\n    });\n\n    const submitChallenge = () => {\n        var data = {\n            'challengeId': challenge.id,\n            'uploadedFileKey': imageUpload.key\n        }\n        axios.post('/submit', data)\n            .then(response => props.onUpload(response.data))\n            .catch(error => console.log(error))\n    }\n\n    const uploadImage = () => {\n        var blob = image.slice(0, image.size, image.type);\n        var renameFile = new File([blob], imageUpload.key, { type: image.type });\n        console.log(renameFile)\n        let req = new XMLHttpRequest();\n        req.open(\"PUT\", imageUpload.url);\n        req.onreadystatechange = function () {\n          if (this.readyState === 4 && this.status === 200) {\n            console.log(\"File Uploaded\")\n            submitChallenge()\n          }\n        }\n        req.send(renameFile);\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    {Object.keys(image).length === 0? \n                        <div {...getRootProps()} className='dropbox'>\n                            <input {...getInputProps()} />\n                            {\n                                isDragActive ? \n                                <div className='drag-text'>Drop image here</div> :\n                                <div className='drag-text'>Drag 'n' drop image here, or click to select a file</div>\n                            }\n                        </div> :\n                        <div className='image-preview'>\n                            <img src={URL.createObjectURL(image)} width='50%' className='image-preview'/>\n                        </div>\n                    }\n                </div>\n            </div>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {Object.keys(imageUpload).length === 0? \n                        <button className='button-rounded-black-disabled text-large' disabled>Upload</button>:\n                        <button className='button-rounded-black text-large' onClick={uploadImage}>Upload</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageUpload;"]},"metadata":{},"sourceType":"module"}