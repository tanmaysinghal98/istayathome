{"ast":null,"code":"var _jsxFileName = \"/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageUpload.js\";\nimport React, { useCallback, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ReactLoading from 'react-loading';\nimport { useDropzone } from 'react-dropzone';\nimport '../styles/ImageUpload.css';\nimport '../styles/Common.css';\n\nconst ImageUpload = props => {\n  const {\n    challenge\n  } = props;\n  const [image, setImage] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [imageUpload, setImageUpload] = useState({});\n  useEffect(() => {\n    if (Object.keys(image).length !== 0) {\n      getPresignedUrl(image);\n    }\n  }, [image]);\n  const onDrop = useCallback(acceptedFiles => {\n    setImage(acceptedFiles[0]);\n\n    if (navigator.canShare && navigator.canShare({\n      files: acceptedFiles\n    })) {\n      alert(\"yes\");\n      navigator.share({\n        files: [image],\n        title: 'Vacation Pictures',\n        text: 'Photos from September 27 to October 14.'\n      }).then(() => console.log('Share was successful.')).catch(error => alert(error));\n    } else {\n      console.log(`Your system doesn't support sharing files.`);\n    }\n  }, []);\n\n  const getPresignedUrl = file => {\n    var data = {\n      'challengeId': props.challenge.id,\n      'fileName': file.name,\n      'fileType': file.type\n    };\n    axios.post('/image/upload', data).then(response => {\n      setImageUpload(response.data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive\n  } = useDropzone({\n    onDrop,\n    accept: 'image/*',\n    multiple: false\n  });\n\n  const submitChallenge = () => {\n    setLoading(true);\n    var data = {\n      'challengeId': challenge.id,\n      'uploadedFileKey': imageUpload.key\n    };\n    axios.post('/submit', data).then(response => {\n      props.onUpload(response.data);\n      setLoading(false);\n    }).catch(error => console.log(error));\n  };\n\n  const uploadImage = () => {\n    var blob = image.slice(0, image.size, image.type);\n    var renameFile = new File([blob], imageUpload.key, {\n      type: image.type\n    });\n    console.log(renameFile);\n    let req = new XMLHttpRequest();\n    req.open(\"PUT\", imageUpload.url);\n\n    req.onreadystatechange = function () {\n      if (this.readyState === 4 && this.status === 200) {\n        console.log(\"File Uploaded\");\n        submitChallenge();\n      }\n    };\n\n    req.send(renameFile);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row justify-content-md-center description-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12 col-md-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }, Object.keys(image).length === 0 ? /*#__PURE__*/React.createElement(\"div\", Object.assign({}, getRootProps(), {\n    className: \"dropbox\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", Object.assign({}, getInputProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 29\n    }\n  })), isDragActive ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"drag-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 33\n    }\n  }, \"Drop image here\") : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"drag-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 33\n    }\n  }, \"Drag 'n' drop image here, or click to select a file\")) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"image-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: URL.createObjectURL(image),\n    width: \"50%\",\n    className: \"image-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 29\n    }\n  })))), loading ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row justify-content-md-center description-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12 col-md-6 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(ReactLoading, {\n    type: 'bubbles',\n    color: '#000000',\n    height: '20%',\n    width: '20%',\n    className: \"loading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 25\n    }\n  }))) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row justify-content-md-center description-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-12 col-md-6 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, loading ? /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button-rounded-black-disabled text-large\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }, \"Uploading\") : Object.keys(imageUpload).length === 0 ? /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button-rounded-black-disabled text-large\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 25\n    }\n  }, \"Upload\") : /*#__PURE__*/React.createElement(\"button\", {\n    className: \"button-rounded-black text-large\",\n    onClick: uploadImage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 25\n    }\n  }, \"Upload\"))));\n};\n\nexport default ImageUpload;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageUpload.js"],"names":["React","useCallback","useState","useEffect","axios","ReactLoading","useDropzone","ImageUpload","props","challenge","image","setImage","loading","setLoading","imageUpload","setImageUpload","Object","keys","length","getPresignedUrl","onDrop","acceptedFiles","navigator","canShare","files","alert","share","title","text","then","console","log","catch","error","file","data","id","name","type","post","response","getRootProps","getInputProps","isDragActive","accept","multiple","submitChallenge","key","onUpload","uploadImage","blob","slice","size","renameFile","File","req","XMLHttpRequest","open","url","onreadystatechange","readyState","status","send","URL","createObjectURL"],"mappings":"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","sourcesContent":["import React, {useCallback, useState, useEffect} from 'react';\nimport axios from 'axios';\nimport ReactLoading from 'react-loading';\nimport {useDropzone} from 'react-dropzone'\nimport '../styles/ImageUpload.css'\nimport '../styles/Common.css';\n\nconst ImageUpload = (props) => {\n    const {challenge} = props;\n    const [image, setImage] = useState({});\n    const [loading, setLoading] = useState(false)\n    const [imageUpload, setImageUpload] = useState({});\n\n    useEffect(() => {\n        if (Object.keys(image).length !== 0) {\n            getPresignedUrl(image)\n        }\n    }, [image])\n\n    const onDrop = useCallback(acceptedFiles => {\n        setImage(acceptedFiles[0])\n        if (navigator.canShare && navigator.canShare({ files: acceptedFiles })) {\n            alert(\"yes\")\n            navigator.share({\n              files: [image],\n              title: 'Vacation Pictures',\n              text: 'Photos from September 27 to October 14.',\n            })\n            .then(() => console.log('Share was successful.'))\n            .catch((error) => alert(error));\n          } else {\n            console.log(`Your system doesn't support sharing files.`);\n          }\n    }, []);\n\n    const getPresignedUrl = (file) => {\n        var data = {\n            'challengeId': props.challenge.id,\n            'fileName' : file.name,\n            'fileType': file.type\n        }\n        axios.post('/image/upload', data)\n            .then(response => {\n                setImageUpload(response.data);\n            })\n            .catch(function (error){\n                console.log(error);\n            })\n    }\n    \n    const {getRootProps, getInputProps, isDragActive} = useDropzone({\n        onDrop,\n        accept: 'image/*',\n        multiple: false\n    });\n\n    const submitChallenge = () => {\n        setLoading(true)\n        var data = {\n            'challengeId': challenge.id,\n            'uploadedFileKey': imageUpload.key\n        }\n        axios.post('/submit', data)\n            .then(response => {\n                props.onUpload(response.data)\n                setLoading(false)\n            })\n            .catch(error => console.log(error))\n    }\n\n    const uploadImage = () => {\n        var blob = image.slice(0, image.size, image.type);\n        var renameFile = new File([blob], imageUpload.key, { type: image.type });\n        console.log(renameFile)\n        let req = new XMLHttpRequest();\n        req.open(\"PUT\", imageUpload.url);\n        req.onreadystatechange = function () {\n          if (this.readyState === 4 && this.status === 200) {\n            console.log(\"File Uploaded\")\n            submitChallenge()\n          }\n        }\n        req.send(renameFile);\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    {Object.keys(image).length === 0? \n                        <div {...getRootProps()} className='dropbox'>\n                            <input {...getInputProps()} />\n                            {\n                                isDragActive ? \n                                <div className='drag-text'>Drop image here</div> :\n                                <div className='drag-text'>Drag 'n' drop image here, or click to select a file</div>\n                            }\n                        </div> :\n                        <div className='image-preview'>\n                            <img src={URL.createObjectURL(image)} width='50%' className='image-preview'/>\n                        </div>\n                    }\n                </div>\n            </div>\n            {loading ? \n                <div className='row justify-content-md-center description-box'>\n                    <div className='col-sm-12 col-md-6 text-center'>\n                        <ReactLoading type={'bubbles'} color={'#000000'} height={'20%'} width={'20%'} className='loading' />\n                    </div>\n                </div> : null\n            }\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {loading ? \n                    <button className='button-rounded-black-disabled text-large' disabled>Uploading</button>:\n                    Object.keys(imageUpload).length === 0? \n                        <button className='button-rounded-black-disabled text-large' disabled>Upload</button>:\n                        <button className='button-rounded-black text-large' onClick={uploadImage}>Upload</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageUpload;"]},"metadata":{},"sourceType":"module"}