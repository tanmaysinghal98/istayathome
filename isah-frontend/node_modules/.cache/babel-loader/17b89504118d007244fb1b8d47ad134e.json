{"ast":null,"code":"import _slicedToArray from\"/Users/tanmaysinghal98/Development/isah/isah-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import'../styles/Common.css';import'../styles/ImageUpload.css';var ImageShare=function ImageShare(props){var challenge=props.challenge,user=props.user;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),imageDownload=_useState2[0],setImageDownload=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];useEffect(function(){var completedChallenge=user.challengesCompleted.find(function(compChal){return compChal.challengeId===challenge.id;});var data={'key':completedChallenge.achievementImageKey};axios.post('/image/download',data).then(function(response){return setImageDownload(response.data);}).catch(function(err){return console.log(err);});},[challenge,user]);useEffect(function(){if(imageDownload.url!==undefined&&imageDownload.url!==null){fetch(imageDownload.url).then(function(response){return response.blob();}).then(function(blob){var file=new File([blob],'download.jpeg',{type:\"image/jpeg\"});setImage(file);});}},[imageDownload]);var share=function share(){if(navigator.canShare&&navigator.canShare({files:[image]})){navigator.share({files:[image],text:'I nominate you to complete this challenge. https://istayathome.in/challenge/'+challenge.id}).then(function(){return console.log('Share was successful.');}).catch(function(error){return downloadImage();});}else{downloadImage();}};var downloadImage=function downloadImage(){var a=document.createElement(\"a\");document.body.appendChild(a);a.style=\"display: none\";a.href=window.URL.createObjectURL(image);a.download='download.jpeg';a.click();};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"image-preview\"},image?/*#__PURE__*/React.createElement(\"img\",{src:window.URL.createObjectURL(image),width:\"50%\",className:\"image-preview\",alt:\"Challenge Completed\"}):null))),/*#__PURE__*/React.createElement(\"div\",{className:\"row justify-content-md-center description-box\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-sm-12 col-md-6 text-center\"},Object.keys(imageDownload).length===0?/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black-disabled text-large\",disabled:true},\"Share\"):/*#__PURE__*/React.createElement(\"button\",{className:\"button-rounded-black text-large\",onClick:share},\"Share\"))));};export default ImageShare;","map":{"version":3,"sources":["/Users/tanmaysinghal98/Development/isah/isah-frontend/src/components/ImageShare.js"],"names":["React","useState","useEffect","axios","ImageShare","props","challenge","user","imageDownload","setImageDownload","image","setImage","completedChallenge","challengesCompleted","find","compChal","challengeId","id","data","achievementImageKey","post","then","response","catch","err","console","log","url","undefined","fetch","blob","file","File","type","share","navigator","canShare","files","text","error","downloadImage","a","document","createElement","body","appendChild","style","href","window","URL","createObjectURL","download","click","Object","keys","length"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport axios from 'axios';\nimport '../styles/Common.css';\nimport '../styles/ImageUpload.css'\n\nconst ImageShare = (props) => {\n    const {challenge, user} = props;\n    const [imageDownload, setImageDownload] = useState({});\n    const [image, setImage] = useState(null);\n\n    useEffect(() => {\n        var completedChallenge = user.challengesCompleted.find(compChal => compChal.challengeId === challenge.id)\n        var data = {\n            'key': completedChallenge.achievementImageKey\n        }\n        axios.post('/image/download', data)\n            .then(response => setImageDownload(response.data))\n            .catch(err => console.log(err))\n    }, [challenge, user])\n\n    useEffect(() => {\n        if (imageDownload.url !== undefined && imageDownload.url !== null) {\n            fetch(imageDownload.url)\n            .then(response => response.blob())\n            .then(blob => {\n                let file = new File([blob], 'download.jpeg', { type: \"image/jpeg\" });\n                setImage(file)\n            })\n        }\n    }, [imageDownload])\n\n    const share = () => {\n        if (navigator.canShare && navigator.canShare({ files: [image] })) {\n            navigator.share({\n              files: [image],\n              text: 'I nominate you to complete this challenge. https://istayathome.in/challenge/' + challenge.id\n            })\n            .then(() => console.log('Share was successful.'))\n            .catch((error) => downloadImage());\n          } else {\n            downloadImage();\n          }\n    }\n\n    const downloadImage = () => {\n        var a = document.createElement(\"a\");\n        document.body.appendChild(a);\n        a.style = \"display: none\";\n        a.href = window.URL.createObjectURL(image);\n        a.download = 'download.jpeg';\n        a.click();\n    }\n\n    return (\n        <>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6'>\n                    <div className='image-preview'>\n                        {image ? \n                        <img src={window.URL.createObjectURL(image)} width='50%' className='image-preview' alt='Challenge Completed'/>\n                        : null}\n                    </div>\n                </div>\n            </div>\n            <div className='row justify-content-md-center description-box'>\n                <div className='col-sm-12 col-md-6 text-center'>\n                    {Object.keys(imageDownload).length === 0? \n                        <button className='button-rounded-black-disabled text-large' disabled>Share</button>:\n                        <button className='button-rounded-black text-large' onClick={share}>Share</button>\n                    }\n                </div>\n            </div>\n        </>\n    )\n}\n\nexport default ImageShare;"]},"metadata":{},"sourceType":"module"}